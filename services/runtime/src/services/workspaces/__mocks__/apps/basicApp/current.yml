name: basicApp
automations:
  basicEmpty:
    name: basicEmpty
    do: []
    output:
      msg: 'result of basicApp.basicEmpty'
    when:
      events:
        - triggerEmpty
      endpoint: true

  throw:
    name: throw
    do:
      - some unknown automation: {}
    when:
      events:
        - throw

  triggerAnotherAutomation:
    name: triggerAnotherAutomation
    when:
      events:
        - triggerAnotherAutomation
    do:
      - emit:
          event: anotherAutomation
          payload: '{{payload}}'

  callsAnotherAutomation:
    name: callsAnotherAutomation
    when:
      events:
        - callsAnotherAutomation
    do:
      - anotherAutomation:
          payload: '{{payload}}'

  anotherAutomation:
    name: anotherAutomation
    when:
      events:
        - anotherAutomation
    output:
      fromAppInstance: '{{payload}}'
    do:
      - emit:
          event: forParentWorkspace
          payload:
            sourceAutomation: '{{run.automationSlug}}'
            sourcePayload: '{{payload}}'
